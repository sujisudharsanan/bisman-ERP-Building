# BISMAN ERP - Penetration Testing Checklist

## Document Information

| Field | Value |
|-------|-------|
| **Application** | BISMAN ERP |
| **Version** | 2.0.0-security |
| **Test Type** | Web Application Penetration Test |
| **Classification** | Confidential |
| **Last Updated** | December 2024 |

---

## üìã Executive Summary

This document provides a comprehensive penetration testing checklist for BISMAN ERP, covering all security-critical endpoints, authentication flows, multi-tenant isolation, and data protection mechanisms.

---

## üéØ Scope & Targets

### In-Scope Targets

| Target | URL/Endpoint | Priority |
|--------|--------------|----------|
| **Production API** | `https://api.bisman.com` | P0 |
| **Staging API** | `https://staging-api.bisman.com` | P0 |
| **Frontend** | `https://app.bisman.com` | P1 |
| **WebSocket** | `wss://api.bisman.com/socket.io` | P1 |
| **Metrics** | `https://api.bisman.com/metrics` | P2 |

### Out-of-Scope

- Third-party integrations (Stripe, Twilio, etc.)
- Infrastructure (Railway, AWS, etc.)
- DDoS testing without prior approval

---

## üîê Test Categories

### 1. Authentication & Session Management (P0 - Critical)

#### 1.1 Login Flow

| ID | Test Case | Priority | Method |
|----|-----------|----------|--------|
| AUTH-001 | Brute force login with rate limit bypass | P0 | Automated |
| AUTH-002 | SQL injection in email/password fields | P0 | Manual + Automated |
| AUTH-003 | Credential stuffing attack | P0 | Automated |
| AUTH-004 | Account enumeration via timing analysis | P0 | Manual |
| AUTH-005 | Password reset token predictability | P0 | Manual |
| AUTH-006 | Session fixation | P0 | Manual |
| AUTH-007 | Session hijacking via XSS | P0 | Manual |
| AUTH-008 | JWT token manipulation | P0 | Manual |
| AUTH-009 | Token expiration enforcement | P1 | Manual |
| AUTH-010 | Concurrent session handling | P1 | Manual |

**Target Endpoints:**
```
POST /api/auth/login
POST /api/auth/register
POST /api/auth/forgot-password
POST /api/auth/reset-password
POST /api/auth/refresh
POST /api/auth/logout
```

**Test Payloads (SQL Injection):**
```
' OR '1'='1
' OR '1'='1' --
admin'--
' UNION SELECT NULL,NULL,NULL--
'; DROP TABLE users;--
```

**Test Payloads (XSS):**
```
<script>alert('XSS')</script>
"><img src=x onerror=alert('XSS')>
javascript:alert('XSS')
```

---

#### 1.2 JWT Token Security

| ID | Test Case | Priority | Method |
|----|-----------|----------|--------|
| JWT-001 | Algorithm confusion (none, HS256 vs RS256) | P0 | Manual |
| JWT-002 | Weak secret brute force | P0 | Automated |
| JWT-003 | Token signature bypass | P0 | Manual |
| JWT-004 | Expired token acceptance | P1 | Manual |
| JWT-005 | Token reuse after logout | P0 | Manual |
| JWT-006 | Sensitive data in token payload | P1 | Manual |

**Test Commands:**
```bash
# Decode JWT without verification
echo $TOKEN | cut -d'.' -f2 | base64 -d

# Test algorithm none
# Modify header: {"alg":"none","typ":"JWT"}

# Test weak secrets
hashcat -a 0 -m 16500 jwt.txt wordlist.txt
```

---

### 2. Authorization & Access Control (P0 - Critical)

#### 2.1 RBAC Testing

| ID | Test Case | Priority | Method |
|----|-----------|----------|--------|
| RBAC-001 | Vertical privilege escalation (user ‚Üí admin) | P0 | Manual |
| RBAC-002 | Horizontal privilege escalation (user A ‚Üí user B data) | P0 | Manual |
| RBAC-003 | Role bypass via direct object reference | P0 | Manual |
| RBAC-004 | Missing function-level access control | P0 | Manual |
| RBAC-005 | Admin endpoint access without admin role | P0 | Manual |
| RBAC-006 | Privilege persistence after role downgrade | P1 | Manual |

**Test Endpoints:**
```
GET /api/admin/users
GET /api/admin/settings
POST /api/admin/users/:id/role
DELETE /api/admin/users/:id
GET /api/invoices/:id  (try other tenant's invoice)
GET /api/tasks/:id     (try other user's task)
```

**Test Approach:**
1. Login as regular user
2. Capture request to admin endpoint
3. Replay with user token
4. Verify access denied (403)

---

#### 2.2 Multi-Tenant Isolation (RLS)

| ID | Test Case | Priority | Method |
|----|-----------|----------|--------|
| RLS-001 | Cross-tenant data access via IDOR | P0 | Manual |
| RLS-002 | Tenant ID manipulation in requests | P0 | Manual |
| RLS-003 | Tenant context bypass in queries | P0 | Manual |
| RLS-004 | Bulk data export with missing RLS | P0 | Manual |
| RLS-005 | API aggregation endpoints leaking cross-tenant data | P0 | Manual |
| RLS-006 | GraphQL/nested queries bypassing RLS | P1 | Manual |

**Test Approach:**
```bash
# Login as Tenant A user
curl -X POST /api/auth/login -d '{"email":"userA@tenantA.com","password":"..."}'

# Try to access Tenant B's invoice
curl -H "Authorization: Bearer $TOKEN_A" \
     /api/invoices/TENANT_B_INVOICE_ID

# Expected: 403 Forbidden or 404 Not Found
# Vulnerability: 200 OK with data
```

---

### 3. Input Validation & Injection (P0 - Critical)

#### 3.1 SQL Injection

| ID | Test Case | Priority | Method |
|----|-----------|----------|--------|
| SQLI-001 | Classic SQL injection in query params | P0 | Automated |
| SQLI-002 | Blind SQL injection (time-based) | P0 | Automated |
| SQLI-003 | Boolean-based blind injection | P0 | Automated |
| SQLI-004 | Second-order SQL injection | P1 | Manual |
| SQLI-005 | SQL injection in JSON body | P0 | Manual |
| SQLI-006 | SQL injection in headers (X-Tenant-ID) | P0 | Manual |

**Target Endpoints:**
```
GET /api/invoices?search=PAYLOAD
GET /api/tasks?filter=PAYLOAD
GET /api/users?email=PAYLOAD
POST /api/reports/generate (body: {"query": "PAYLOAD"})
```

**Tools:**
```bash
# SQLMap automated testing
sqlmap -u "https://api.bisman.com/api/invoices?search=test" \
       --cookie="auth_token=..." \
       --level=3 --risk=2
```

---

#### 3.2 NoSQL Injection

| ID | Test Case | Priority | Method |
|----|-----------|----------|--------|
| NOSQL-001 | MongoDB operator injection ($gt, $ne) | P1 | Manual |
| NOSQL-002 | JSON injection in query params | P1 | Manual |

**Test Payloads:**
```json
{"email": {"$gt": ""}, "password": {"$gt": ""}}
{"email": {"$ne": null}}
{"$where": "sleep(5000)"}
```

---

#### 3.3 XSS (Cross-Site Scripting)

| ID | Test Case | Priority | Method |
|----|-----------|----------|--------|
| XSS-001 | Reflected XSS in search/filter params | P0 | Automated |
| XSS-002 | Stored XSS in user profile fields | P0 | Manual |
| XSS-003 | Stored XSS in comments/notes | P0 | Manual |
| XSS-004 | DOM-based XSS | P1 | Manual |
| XSS-005 | XSS via file upload (SVG, HTML) | P0 | Manual |
| XSS-006 | XSS in PDF/report generation | P1 | Manual |

**Test Endpoints:**
```
POST /api/users/profile (name, bio fields)
POST /api/tasks (title, description)
POST /api/comments
POST /api/chat/messages
```

---

### 4. Rate Limiting & Abuse Prevention (P1 - High)

| ID | Test Case | Priority | Method |
|----|-----------|----------|--------|
| RATE-001 | Login rate limit effectiveness | P0 | Automated |
| RATE-002 | Rate limit bypass via IP rotation | P1 | Manual |
| RATE-003 | Rate limit bypass via headers (X-Forwarded-For) | P1 | Manual |
| RATE-004 | API endpoint rate limits | P1 | Automated |
| RATE-005 | WebSocket connection flooding | P1 | Automated |
| RATE-006 | Resource exhaustion (large payloads) | P1 | Manual |

**Test Commands:**
```bash
# Brute force with rate limit testing
for i in {1..100}; do
  curl -X POST /api/auth/login \
       -d '{"email":"test@test.com","password":"wrong'$i'"}' \
       -w "%{http_code}\n" -o /dev/null -s
done

# X-Forwarded-For bypass
curl -H "X-Forwarded-For: 1.2.3.$RANDOM" /api/auth/login
```

---

### 5. File Upload & Handling (P1 - High)

| ID | Test Case | Priority | Method |
|----|-----------|----------|--------|
| FILE-001 | Unrestricted file upload (executable) | P0 | Manual |
| FILE-002 | File type validation bypass | P0 | Manual |
| FILE-003 | Path traversal in filename | P0 | Manual |
| FILE-004 | XXE via file upload (XML, DOCX) | P1 | Manual |
| FILE-005 | Server-side request forgery via file URL | P1 | Manual |
| FILE-006 | File size limit bypass | P2 | Manual |

**Test Payloads:**
```
# Filename traversal
../../../etc/passwd
....//....//....//etc/passwd

# Extension bypass
shell.php.jpg
shell.php%00.jpg
shell.pHp
shell.php5
```

---

### 6. API Security (P1 - High)

#### 6.1 REST API

| ID | Test Case | Priority | Method |
|----|-----------|----------|--------|
| API-001 | Mass assignment vulnerability | P1 | Manual |
| API-002 | Excessive data exposure | P1 | Manual |
| API-003 | Broken object-level authorization (BOLA) | P0 | Manual |
| API-004 | Lack of resource rate limiting | P1 | Automated |
| API-005 | Improper inventory management (hidden endpoints) | P2 | Automated |
| API-006 | Security misconfiguration (verbose errors) | P1 | Manual |

**Test for BOLA:**
```bash
# Get invoice as owner
curl -H "Authorization: Bearer $USER_A_TOKEN" /api/invoices/123
# Returns: Invoice data (correct)

# Get same invoice as different user
curl -H "Authorization: Bearer $USER_B_TOKEN" /api/invoices/123
# Expected: 403 or 404
# Vulnerable: 200 with data
```

---

### 7. WebSocket Security (P2 - Medium)

| ID | Test Case | Priority | Method |
|----|-----------|----------|--------|
| WS-001 | Authentication bypass on WebSocket | P1 | Manual |
| WS-002 | Cross-site WebSocket hijacking | P1 | Manual |
| WS-003 | Message injection | P1 | Manual |
| WS-004 | Denial of service via message flooding | P2 | Automated |
| WS-005 | Subscription to unauthorized channels | P1 | Manual |

**Test Endpoints:**
```
wss://api.bisman.com/socket.io/?transport=websocket
wss://api.bisman.com/chat
```

---

### 8. Infrastructure & Configuration (P2 - Medium)

| ID | Test Case | Priority | Method |
|----|-----------|----------|--------|
| CONF-001 | TLS/SSL misconfiguration | P1 | Automated |
| CONF-002 | Security headers missing/misconfigured | P1 | Automated |
| CONF-003 | CORS misconfiguration | P1 | Manual |
| CONF-004 | Verbose error messages | P2 | Manual |
| CONF-005 | Debug mode enabled in production | P1 | Manual |
| CONF-006 | Sensitive data in URLs/logs | P1 | Manual |
| CONF-007 | Default credentials | P0 | Manual |
| CONF-008 | Exposed admin interfaces | P1 | Automated |

**Test Commands:**
```bash
# SSL test
testssl.sh https://api.bisman.com

# Security headers
curl -I https://api.bisman.com | grep -E "^(X-|Content-Security|Strict-Transport)"

# CORS test
curl -H "Origin: https://evil.com" -I https://api.bisman.com/api/health
```

---

## üõ†Ô∏è Tools & Setup

### Required Tools

| Tool | Purpose | Installation |
|------|---------|--------------|
| **Burp Suite Pro** | Proxy, scanner | Commercial |
| **SQLMap** | SQL injection | `apt install sqlmap` |
| **Nuclei** | Vulnerability scanner | `go install github.com/projectdiscovery/nuclei` |
| **ffuf** | Fuzzing | `go install github.com/ffuf/ffuf` |
| **jwt_tool** | JWT testing | `pip install jwt_tool` |
| **testssl.sh** | SSL/TLS testing | GitHub |
| **wfuzz** | Web fuzzer | `pip install wfuzz` |

### Environment Setup

```bash
# Clone pentest scripts
git clone https://github.com/your-org/bisman-pentest.git

# Set target variables
export TARGET="https://api.bisman.com"
export STAGING_TARGET="https://staging-api.bisman.com"

# Get test credentials (from secure vault)
export TEST_USER_EMAIL="pentest@bisman.test"
export TEST_USER_PASSWORD="<from-vault>"
```

---

## üìä Severity Classification

| Severity | CVSS Score | Example | SLA |
|----------|------------|---------|-----|
| **Critical** | 9.0-10.0 | RCE, Auth bypass, Data breach | 24 hours |
| **High** | 7.0-8.9 | SQLi, XSS, Privilege escalation | 72 hours |
| **Medium** | 4.0-6.9 | CSRF, Information disclosure | 7 days |
| **Low** | 0.1-3.9 | Verbose errors, Missing headers | 30 days |
| **Info** | 0.0 | Best practice recommendations | Next release |

---

## üìù Reporting Template

### Finding Report Structure

```markdown
## [SEVERITY] Finding Title

**ID:** BISMAN-2024-XXX
**CVSS:** X.X (Vector String)
**Status:** Open/Fixed/Accepted Risk

### Description
[Detailed description of the vulnerability]

### Affected Components
- Endpoint: /api/xxx
- Parameter: xxx

### Steps to Reproduce
1. Step 1
2. Step 2
3. Step 3

### Proof of Concept
[Request/response or screenshot]

### Impact
[Business impact description]

### Remediation
[Specific fix recommendation]

### References
- CWE-XXX: [Link]
- OWASP: [Link]
```

---

## ‚úÖ Pre-Test Checklist

- [ ] Scope and rules of engagement signed
- [ ] Test credentials obtained
- [ ] Staging environment verified
- [ ] Backup of test data confirmed
- [ ] Incident response contact available
- [ ] Testing window approved
- [ ] VPN/IP whitelist configured
- [ ] Logging enabled for audit trail

---

## üìÖ Test Schedule

| Phase | Duration | Focus |
|-------|----------|-------|
| **Reconnaissance** | 1 day | Endpoint discovery, tech stack |
| **Authentication Testing** | 2 days | Login, JWT, sessions |
| **Authorization Testing** | 2 days | RBAC, RLS, tenant isolation |
| **Injection Testing** | 2 days | SQLi, XSS, SSTI |
| **API Testing** | 1 day | BOLA, rate limits, headers |
| **Reporting** | 2 days | Findings, remediation |

**Total Duration:** 10 days

---

## üìû Emergency Contacts

| Role | Name | Contact |
|------|------|---------|
| Security Lead | [Name] | [Phone/Email] |
| DevOps Lead | [Name] | [Phone/Email] |
| Incident Response | [Name] | [Phone/Email] |

---

## üìö References

- [OWASP Testing Guide v4.2](https://owasp.org/www-project-web-security-testing-guide/)
- [OWASP API Security Top 10](https://owasp.org/www-project-api-security/)
- [PTES - Penetration Testing Execution Standard](http://www.pentest-standard.org/)
- [NIST SP 800-115](https://csrc.nist.gov/publications/detail/sp/800-115/final)
